<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Differential Expression Between Groups — get_diff • ezRNAseq</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">ezRNAseq</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Differential Expression Between Groups</h1>
    </div>

    
    <p>Identify differentially expressed genes between groups:
<ul>
<li> <b>get_diff_1()</b>: Common up/down regulated genes in one group compared to each
of the other groups in pairwise analysis. It&#39;s an alias of get_diff_pwc() when length(grp1) = 1.
</li>
<li> <b>get_diff_2()</b>: Differentially expressed genes between two groups in a simple two class analysis.
Alias of get_diff_pwc() when length(grp1) = length(grp2) = 1.
</li>
<li> <b>get_diff_n()</b>: Differentially expressed genes between multiple groups
using pairewise analysis or not (see details section).
</li>
<li> <b>get_diff_pwc()</b>: Pairwise comparisons (pwc) between sample classes in grp1 (e.g.: grp1 = c(&quot;A&quot;, &quot;B&quot;, ...))
and sample classes in grp2 (e.g.: grp2 = c(&quot;C&quot;, &quot;D&quot;, ...) ). Can do all the above mentioned type of analyses.
It&#39;s an alias of get_diff_n(), get_diff_1( ) and get_diff_2().
</li>
<li> <b>significant()</b>: Take an object of class &quot;get_diff&quot;, &quot;lm_results&quot; or &quot;DESeqResult&quot; and returns
significantly differentially expressed genes with a given cutoff for false discovery rate
and fold change.
</li>
</ul></p>

    <p>For more information about these functions, read details section.</p>
    

    <pre><span class='fu'>get_diff_1</span>(<span class='no'>dds</span>, <span class='no'>factor</span>, <span class='no'>grp1</span>, <span class='kw'>grp2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>fc</span> <span class='kw'>=</span> <span class='fl'>1.5</span>,
  <span class='kw'>active_exprs</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>count.norm</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>exprs.norm</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='fu'>get_diff_2</span>(<span class='no'>dds</span>, <span class='no'>factor</span>, <span class='no'>grp1</span>, <span class='no'>grp2</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>fc</span> <span class='kw'>=</span> <span class='fl'>1.5</span>,
  <span class='kw'>active_exprs</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>count.norm</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>exprs.norm</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='fu'>get_diff_n</span>(<span class='no'>dds</span>, <span class='no'>factor</span>, <span class='no'>grp1</span>, <span class='kw'>grp2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>fc</span> <span class='kw'>=</span> <span class='fl'>1.5</span>,
  <span class='kw'>active_exprs</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>count.norm</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>exprs.norm</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>merge</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='fu'>get_diff_pwc</span>(<span class='no'>dds</span>, <span class='no'>factor</span>, <span class='no'>grp1</span>, <span class='kw'>grp2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>fc</span> <span class='kw'>=</span> <span class='fl'>1.5</span>,
  <span class='kw'>active_exprs</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>count.norm</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>exprs.norm</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>merge</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='fu'>significant</span>(<span class='no'>object</span>, <span class='kw'>fdr</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>fc</span> <span class='kw'>=</span> <span class='fl'>1.5</span>, <span class='kw'>orderby</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"padj"</span>, <span class='st'>"lfc"</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>dds</dt>
      <dd>an object of class:
<ul>
<li> DESeqDataSet containing the results of the function DESeq(), or
 </li>
<li> lm_fit
</li>
</ul>

dds must contain the information about samples.</dd>
      <dt>factor</dt>
      <dd>the name of a factor in the design formula.</dd>
      <dt>grp1, grp2</dt>
      <dd>a list of 2 character vectors containing the groups to be compared.
The argument grp1 is used as numerator and grp2 as the denominator for computing the fold change (See details  section).
If grp2 is NULL, then grp1 is compared to all the other groups in the data.</dd>
      <dt>alpha</dt>
      <dd>The significance cutoff used for optimizing the independent filtering
(by default 0.05); see ?DESeq2::results.</dd>
      <dt>fc</dt>
      <dd>the fold change threshold. Only genes with an absolute fold change &gt;= fc and adjusted p-value &lt;= fdr
and a detection_call = 1, are considered as significantly differentially expressed.</dd>
      <dt>active_exprs</dt>
      <dd>a numeric value specifying detected expression cutoff.
If not NULL, any gene with an average expression above this cutoff, in at least one group,
is declared as actively expressed. Used for defining presence and absence detection call.
If not NULL, a column named detection_call is added to the result. Possible values for detection_call
is 0 (the gene is not actively expressed) or 1 (the gene is actively expressed).</dd>
      <dt>count.norm</dt>
      <dd>a data frame containing the normalized count as provided by DESeq2.
Only used for computing the detection call when active_expression is not NULL.</dd>
      <dt>exprs.norm</dt>
      <dd>a data frame containing the normalized gene expression data. An alias of count.norm.</dd>
      <dt>verbose</dt>
      <dd>logical value; if TRUE the progression is shown. Default is TRUE.</dd>
      <dt>...</dt>
      <dd>other arguments to be passed to the functions DESeq2:results() or lm_results()</dd>
      <dt>merge</dt>
      <dd>a logical value. Default is FALSE. Used only in multiclass comparison cases (seee details section).</dd>
      <dt>object</dt>
      <dd>an object of class get_diff, DE_Results, DESeqResults or a data frame containing the
columns padj, log2FoldChange and optionally the column detection_call.</dd>
      <dt>fdr</dt>
      <dd>Accepted false discovery rate for considering genes as differentially expressed.</dd>
      <dt>orderby</dt>
      <dd>possible values are &quot;padj&quot; and &quot;lfc&quot; for ordering
significant genes by the adjusted p-value or the log2FoldChange</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><ul>
<li> The functions get_diff_*() returns an object of class DESeqResults (see ?DESeq2::results) and &quot;get_diff&quot; which contains
the following columns: baseMean, log2FoldChange, lfcSE, stat, pvalue, padj, detection_call and significance.
To see the description of the columns use the function mcols(res, use.names = TRUE), where res is the
result of get_diff_*().
The function plot() can be used to draw the results. (See ?plot_MA).
</li>
<li> significant() returns an object of class &quot;significant&quot; containing
significantly differentially expressed genes
with a given cutoff for false discovery rate (e.g.: 0.05) and fold change (e.g.: 1.5) and,
a detection_call =1 (if available in the argument object).
The object &quot;significant&quot; is a list with the following components:
<ul>
<li> up: data frame containing upregulated genes in grp1 compared to grp2
 </li>
<li> down: data frame containing downregulated genes in grp1 compared to grp2
 </li>
<li> nup: number of upregulated genes
 </li>
<li> ndown: number of downregulated genes
</li>
</ul></p>
    <p></li>
</ul></p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Definition of general terms contained in the results returned by get_diff_*() functions:
<ul>
<li> The <b>log2FoldChange</b> is calculated using grp1 as numerator and grp2 as denominator.
</li>
<li> The <b>baseMean</b> is calculated as mean of normalized counts for all samples.
</li>
<li> The <b>detection_call</b> defines gene presence/absence detection calls which possible values are:
0 (the gene is not actively expressed) or 1 (the gene is actively expressed,
i.e. normalize expression &gt;= active_exprs cutoff).
</li>
<li> <b>significance</b>: Deregulation significance: Up = 1; Down = -1; Not significant = 0. A gene is
significantly deregulated if a) the detection_call = 1, b) the fold change &gt;= fc cutoff
and c) the padj &lt; = alpha cutoff.
</li>
</ul></p>
    <p>Possible values for the arguments grp1 and grp2 can be of the forms:
<ul>
<li> <b>grp1 = &quot;A&quot; and grp2 = &quot;B&quot;</b>: Simple two class comparisons.
Recommended functions: <b>get_diff_2()</b> or <b>get_diff_pwc()</b>.
The <b>adjusted p-values</b> (padj) and the <b>log2 fold changes</b> (log2FoldChange) are those returned by
DESeq2::results.
</li>
<li> <b>grp1 = &quot;A&quot; and grp2 = c(&quot;B&quot;, &quot;C&quot;, ...)</b>. One class compared to more than one other groups.
Recommended functions: <b>get_diff_1()</b> or <b>get_diff_pwc()</b> for identifying common up/down regulated genes
in group A compared to each of groups B and C using pairwise analysis (e.g.: A vs B and A vs C).
<ul>
<li> <b>Adjusted p-value</b>: The maximum of all the adjusted p-values (padj) obtained from the different pairwise comparisons
is used as the final padj in the results. For a given gene, a max(padj) &lt; 0.05 indicates that each of the padj is &lt; 0.05 in
all pairwise comparisons. If a gene is upregulated in one comparison but downregulated in another comparison,
then the max(padj) is set to NA. Only genes commonly up- or down- regulated in all the comparisons are considered to be
specific gene signatures of grp1.
</li>
<li> <b>log2 fold change</b>: The minimum of all log2FoldChange (lfc) obtained from the different pairwise comparisons
is used as the final log2FoldChange. For a given gene, min(lfc) &gt; 1.5 in absolute value (abs) indicates that
each of the abs(lfcs) is &gt; 1.5 in all pairwise comparisons. If a gene is upregulated in one comparison but downregulated in another comparison,
then the min(lfc) is set to 0. Only genes commonly up- or down- regulated in all the comparisons are considered to be
specific gene signatures of grp1.
</li>
<li> <b>lfcSE, stat and pvalue</b>: These columns can be ignored in the result as they are
obtained by performing a global comparison (not a pairwise comparison) between grp1 and grp2.
We kept them only for conveniance with DESeq2 result formats.
</li>
</ul></p>
    <p></li>
<li> <b>grp1 = c(&quot;A&quot;, &quot;B&quot;, ...) and grp2 = c(&quot;D&quot;, &quot;E&quot;, ...)</b>; Multiple class comparisons.
Recommended functions: <b>get_diff_n()</b> or <b>get_diff_pwc()</b>.
 <ul>
<li> If merge = TRUE, then A+B are merged and compared to merged D+E in a single two class analysis.
   The <b>adjusted p-values</b> (padj) and the <b>log2 fold changes</b> (log2FoldChange)
   are those returned by DESeq2::results.
   </li>
<li> If merge = FALSE, then separated pairewise comparisons are performed using <b>get_diff_pwc()</b>,
   for example as follow: &quot;A&quot; vs c(&quot;D&quot;, &quot;E&quot;, ...) and &quot;B&quot; vs c(&quot;D&quot;, &quot;E&quot;, ...). In this particular case, the
   different comparisons are  A vs D, A vs E, B vs D and B vs E, etc.
   Kept genes in the final results, are only those commonly up/down regulated
   in both A and B compared to D and E.
   The returned results have the same format as those returned by get_diff_1().
   Read the paragraphs above concerning <b>adjusted p-value</b> and log2 fold change.
</li>
</ul></p>
    <p></li>
</ul></p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alboukadel Kassambara.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
